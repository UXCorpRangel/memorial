---
import BaseLayout from "@layouts/BaseLayout.astro";
import { getResolvedSections } from "@blocks/registry.js";

const sections = getResolvedSections();
---

<BaseLayout title="Memorial Landing">
  <main class="overflow-x-hidden">
    {sections.map(({ Component, props }) => <Component {...props} />)}
  </main>
</BaseLayout>

<script>
  import { getUser } from "@/client/user.client";
  try {
    const user = await getUser();
    if (user) {
      localStorage.setItem("user", JSON.stringify(user));
    }
  } catch (error) {
    console.error("error: ", error);
    localStorage.removeItem("user");
  }
</script>
